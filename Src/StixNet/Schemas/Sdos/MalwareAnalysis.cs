using StixNet.Schemas;

namespace StixNet.Sdos;

public class MalwareAnalysis : STIXObject
{
    //    product, version, host_vm_ref, operating_system_ref, installed_software_refs, 
    //configuration_version, modules, analysis_engine_version, analysis_definition_version, 
    //submitted, analysis_started, analysis_ended, result_name, result, analysis_sco_refs, 
    //sample_ref

    public string? Product { get; set; }
    public string? Version { get; set; }
    public string? HostVmRef { get; set; } // identifier
    public string? OperatingSystemRef { get; set; } // identifiers
    public IEnumerable<string> InstalledSoftwareRefs { get; set; } // list of identifiers
    public string? ConfigurationVersion { get; set; } 
    public IEnumerable<string> Modules { get; set; }
    public string? AnalysisEngineVersion { get; set; }
    public DateTime Submitted { get; set; }
    public DateTime AnalysisStarted { get; set; }
    public DateTime AnalysisEnded { get; set; }
    public string? ResultName { get; set; }
    public string? Result { get; set; } // open-vocab
    public IEnumerable<string> AnalysisScoRefs { get; set; } // list of ientifiers
    public string? SampleRef { get; set; } // identifier

    public MalwareAnalysis()
    {
        Modules = new List<string>();
        AnalysisScoRefs = new List<string>();
        InstalledSoftwareRefs = new List<string>();
    }
}
